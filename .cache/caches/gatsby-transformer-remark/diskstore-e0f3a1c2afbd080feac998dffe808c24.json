{"expireTime":9007200839305450000,"key":"transformer-remark-markdown-html-100e20af8c9d158dc264acb75b0ab9c1-gatsby-remark-imagesgatsby-remark-responsive-iframegatsby-remark-prismjsgatsby-remark-copy-linked-filesgatsby-remark-smartypants-","val":"<p>Every once in a while a client I’m working with needs some custom data from our\nRails app. Usually it’s granular and they need it before the end of day to land a\ndeal or impress somebody who I’ll probably never meet. Long story short I find\nmyself in rails console exporting a CSV. Here’s what that looks like. It’s\nnormally much more intricate than this, but for example purposes this will\nsuffice.</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token keyword\">require</span> <span class=\"token string\">'csv'</span> <span class=\"token comment\"># We need this since we're working with a CSV</span>\nfile <span class=\"token operator\">=</span> <span class=\"token string\">\"<span class=\"token interpolation\"><span class=\"token delimiter tag\">#{</span><span class=\"token constant\">Rails</span><span class=\"token punctuation\">.</span>root<span class=\"token delimiter tag\">}</span></span>/public/export.csv\"</span> <span class=\"token comment\"># Now we'll define where the file will be saved</span>\nheader <span class=\"token operator\">=</span> <span class=\"token string\">%w[brand number_of_products]</span> <span class=\"token comment\"># Let's define the header of the file</span>\nbrands <span class=\"token operator\">=</span> <span class=\"token constant\">Brand</span><span class=\"token punctuation\">.</span>all<span class=\"token punctuation\">.</span>map <span class=\"token punctuation\">{</span> <span class=\"token operator\">|</span>brand<span class=\"token operator\">|</span> <span class=\"token punctuation\">{</span>name<span class=\"token punctuation\">:</span> brand<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">,</span> number_of_products<span class=\"token punctuation\">:</span> brand<span class=\"token punctuation\">.</span>products<span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span>\n\n<span class=\"token constant\">CSV</span><span class=\"token punctuation\">.</span>open<span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">,</span> <span class=\"token string\">'w'</span><span class=\"token punctuation\">,</span> write_headers<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span> headers<span class=\"token punctuation\">:</span> header<span class=\"token punctuation\">)</span> <span class=\"token keyword\">do</span> <span class=\"token operator\">|</span>write<span class=\"token operator\">|</span>\n  brands<span class=\"token punctuation\">.</span><span class=\"token keyword\">each</span> <span class=\"token keyword\">do</span> <span class=\"token operator\">|</span>b<span class=\"token operator\">|</span>\n    write <span class=\"token operator\">&lt;</span><span class=\"token operator\">&lt;</span> <span class=\"token punctuation\">[</span>b<span class=\"token punctuation\">[</span><span class=\"token symbol\">:name</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">[</span><span class=\"token symbol\">:number_of_products</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token comment\"># Here's where we'll write the rows</span>\n  <span class=\"token keyword\">end</span>\n<span class=\"token keyword\">end</span></code></pre></div>"}